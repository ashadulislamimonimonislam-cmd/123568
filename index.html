<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AD FREE FIRE - SECURE ACCESS</title>
    <style>
        body { 
            margin: 0; 
            min-height: 100vh; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; 
            background: #050a0f; 
            color: #ffffff; 
            padding: 20px 0;
        }
        
        .container { 
            background: #0d1117; 
            border: 1px solid #30363d; 
            padding: 25px; 
            border-radius: 20px; 
            width: 350px; 
            text-align: left; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .header-box {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .logo-img {
            width: 65px; 
            height: 65px;
            border-radius: 12px;
            border: 1px solid #444;
            object-fit: cover;
            background: #161b22;
        }

        .header-text h2 {
            margin: 0;
            font-size: 18px;
            color: #e6edf3;
        }

        .badge {
            background: rgba(45, 194, 150, 0.15);
            color: #2dc296;
            font-size: 10px;
            padding: 3px 10px;
            border-radius: 20px;
            border: 1px solid #2dc296;
            text-transform: uppercase;
            font-weight: bold;
        }

        .live-time-box {
            font-size: 12px;
            color: #f2cc60;
            margin-bottom: 10px;
            font-family: monospace;
            background: rgba(242, 204, 96, 0.1);
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
        }

        .system-log {
            background: #010409;
            border-radius: 10px;
            padding: 15px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 11px;
            color: #d2a8ff;
            margin-top: 10px;
            line-height: 1.5;
            border: 1px solid #21262d;
        }
        .log-time { color: #f2cc60; margin-right: 5px; }
        .log-header { color: #ffffff; font-weight: bold; display: block; margin-bottom: 5px; font-size: 13px; }

        .info-section {
            margin-top: 25px;
            border-top: 1px solid #30363d;
            padding-top: 20px;
        }
        .info-title {
            color: #58a6ff;
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            display: block;
        }
        .feature-list {
            list-style: none;
            padding: 0;
            font-size: 12px;
            color: #c9d1d9;
            margin-bottom: 20px;
        }
        .feature-list li {
            margin-bottom: 8px;
            padding-left: 15px;
            position: relative;
        }
        .feature-list li::before {
            content: "•";
            color: #58a6ff;
            position: absolute;
            left: 0;
        }

        #landingPage, #generatorPage { display: none; }
        
        .btn { 
            background: #238636; 
            color: #ffffff; 
            border: none; 
            padding: 14px; 
            font-weight: bold; 
            cursor: pointer; 
            border-radius: 10px; 
            width: 100%; 
            margin-top: 20px;
            text-transform: uppercase; 
            text-decoration: none; 
            display: inline-block; 
            text-align: center;
        }

        #keyDisplay { 
            text-align: center;
            padding: 15px; 
            font-size: 20px; 
            color: #58a6ff; 
            background: #161b22;
            border-radius: 10px;
            margin: 15px 0;
            border: 1px solid #30363d;
        }
    </style>
</head>
<body>

    <div id="landingPage" class="container">
        <div class="header-box">
            <img src="https://i.supaimg.com/46dbfc30-50e2-42f9-8305-e5d132e1b867.jpg" class="logo-img" alt="Logo">
            <div class="header-text">
                <span class="badge">SECURE ACCESS PANEL</span>
                <h2>AD FREE FIRE - Key</h2>
            </div>
        </div>

        <div class="live-time-box">Current Time: <span class="live-clock"></span></div>

        <div class="system-log">
            <span class="log-header">System Log</span>
            <div><span class="log-time" class="live-clock-log"></span> Click "GET VIP KEY" and complete steps.</div>
        </div>

        <a id="earningBtn" class="btn" href="#" target="_blank">GET VIP KEY NOW</a>

        <div class="info-section">
            <span class="info-title">How It Works</span>
            <ul class="feature-list">
                <li><strong>Generate:</strong> আর্নিং লিংক সম্পন্ন করে ফিরে আসুন।</li>
                <li><strong>Verify:</strong> স্বয়ংক্রিয়ভাবে জেনারেটর পেজ ওপেন হবে।</li>
                <li><strong>Limit:</strong> প্রতিবার নতুন কী এর জন্য নতুন করে লিঙ্ক ভিজিট করতে হবে।</li>
            </ul>
        </div>
    </div>

    <div id="generatorPage" class="container">
        <div class="header-box">
            <img src="https://i.supaimg.com/46dbfc30-50e2-42f9-8305-e5d132e1b867.jpg" class="logo-img" alt="Logo">
            <div class="header-text">
                <span class="badge">ACCESS GRANTED</span>
                <h2>AD FREE FIRE</h2>
            </div>
        </div>

        <div class="live-time-box">Current Time: <span class="live-clock"></span></div>

        <div id="keyDisplay">VERIFIED ACCESS</div>
        
        <button id="genBtn" class="btn" onclick="generateKey()">VERIFY NEW KEY</button>
        <button id="copyBtn" class="btn" style="display:none; background:#1f6feb;" onclick="copyKey()">COPY KEY</button>

        <div class="system-log" style="margin-top: 25px;">
            <span class="log-header">Server Status</span>
            <div><span class="log-time" class="live-clock-log"></span> Key generation system online.</div>
        </div>

        <div class="info-section">
            <span class="info-title">Status</span>
            <ul class="feature-list">
                <li><strong>Identity:</strong> Verified successfully.</li>
                <li><strong>Usage:</strong> Valid for one-time use.</li>
            </ul>
        </div>
    </div>

<script>
    const EARNING_LINK = "https://linksgo.in/3i6m";
    const REQUIRED_DOMAIN = "linksgo.in";
    const AIRTABLE_TOKEN = "patn7xmqXpUwZql5B.0c757efdff357a4cf8eee80f5e2e28a0ad16e2e84e6d6493ab62a6da54131eae";
    const BASE_ID = "appbcvyIYXVAZzmom";
    const TABLE_ID = "tbl1pjDWPEnDOeym5";

    function updateClock() {
        const now = new Date();
        const timeStr = now.toLocaleTimeString(); 
        const logTimeStr = `[${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}]`;
        
        document.querySelectorAll('.live-clock').forEach(el => el.innerText = timeStr);
        document.querySelectorAll('.live-clock-log').forEach(el => el.innerText = logTimeStr);
    }
    setInterval(updateClock, 1000);

    window.onload = function() {
        updateClock();
        document.getElementById('earningBtn').href = EARNING_LINK;

        // চেক: রেফারার এবং কী জেনারেশন স্ট্যাটাস
        const isFromEarning = document.referrer.includes(REQUIRED_DOMAIN);
        const alreadyUsed = sessionStorage.getItem('keyUsed') === 'true';

        // যদি আর্নিং লিংক থেকে আসে এবং এই সেশনে এখনও কী না নিয়ে থাকে
        if (isFromEarning && !alreadyUsed) {
            document.getElementById('generatorPage').style.display = 'block';
            document.getElementById('landingPage').style.display = 'none';
        } else {
            // অন্যথায় সব সময় ল্যান্ডিং পেজ
            document.getElementById('landingPage').style.display = 'block';
            document.getElementById('generatorPage').style.display = 'none';
            // নতুন করে শুরু করতে সেশন ক্লিয়ার (ঐচ্ছিক)
            sessionStorage.removeItem('keyUsed');
        }
    };

    async function generateKey() {
        const genBtn = document.getElementById('genBtn');
        genBtn.disabled = true;
        genBtn.innerText = "Verifying...";

        const newKey = "GUJJU-" + Math.random().toString(36).substring(2, 8).toUpperCase();

        try {
            const response = await fetch(`https://api.airtable.com/v0/${BASE_ID}/${TABLE_ID}`, {
                method: 'POST',
                headers: { 
                    'Authorization': `Bearer ${AIRTABLE_TOKEN}`, 
                    'Content-Type': 'application/json' 
                },
                body: JSON.stringify({ "fields": { "Password": newKey } })
            });

            if (response.ok) {
                document.getElementById('keyDisplay').innerText = newKey;
                genBtn.style.display = 'none';
                document.getElementById('copyBtn').style.display = 'block';

                // গুরুত্বপূর্ণ: একবার পাসওয়ার্ড পাওয়া হয়ে গেছে
                // এখন পেজ রিফ্রেশ করলে ইউজারকে আবার আর্নিং লিংকে যেতে হবে
                sessionStorage.setItem('keyUsed', 'true');
            } else {
                alert("এয়ারটেবল সার্ভারে সমস্যা! আবার চেষ্টা করুন।");
                genBtn.disabled = false;
                genBtn.innerText = "VERIFY NEW KEY";
            }
        } catch (e) {
            alert("নেটওয়ার্ক সমস্যা! ইন্টারনেট চেক করুন।");
            genBtn.disabled = false;
            genBtn.innerText = "VERIFY NEW KEY";
        }
    }

    function copyKey() {
        const key = document.getElementById('keyDisplay').innerText;
        navigator.clipboard.writeText(key).then(() => {
            alert("✨ Key Copied Successfully!");
        });
    }
</script>
</body>
</html>
